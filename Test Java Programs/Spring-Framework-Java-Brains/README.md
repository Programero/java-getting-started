# Spring Framework Java Brains Project

## Overview

This project demonstrates a Spring Framework application that implements aspect-oriented programming (AOP) with custom retry logic. The application uses Maven as both a build management and dependency management tool to handle the complex Spring Framework dependencies and create deployable artifacts.

## Build Management & Dependency Management

### Maven as Build Tool
This project uses **Apache Maven** for:
- **Build Management**: Compiling source code, running tests, packaging artifacts
- **Dependency Management**: Automatically resolving and downloading Spring Framework and other dependencies
- **Project Structure**: Following Maven's standard directory layout
- **Lifecycle Management**: Clean, compile, test, package, install, deploy phases

### Dependencies Used
- **Spring Context** (6.1.0): Core Spring IoC container
- **Spring AOP** (6.1.0): Aspect-oriented programming support
- **AspectJ Weaver** (1.9.20.1): AOP weaving at runtime
- **GSON** (2.10.1): JSON processing
- **Javax Annotation API** (1.3.2): Annotation support

## Maven Commands

### Basic Build Commands

#### Clean the Project
Removes all files generated by the previous build.
```bash
mvn clean
```

#### Compile the Project
Compiles the source code and copies resources.
```bash
mvn compile
```

#### Run Tests
Compiles and runs unit tests.
```bash
mvn test
```

#### Package the Application
Compiles, tests, and packages the application into a JAR file.
```bash
mvn package
```

#### Full Clean Build
Cleans, compiles, tests, and packages the application.
```bash
mvn clean package
```

### Execute the DrawingApp Class

#### Using Maven Exec Plugin (Development)
Run the application directly using Maven (requires all dependencies to be resolved).
```bash
mvn exec:java
```

#### Using Java with Fat JAR (Production)
Run the packaged application (recommended for deployment).
```bash
java -jar target/Spring-Framework-Java-Brains-1.0-SNAPSHOT.jar
```

## Deployment Strategy

### Why Single Fat JAR?

We created a **deployment folder** with a single JAR file containing all dependencies for the following reasons:

#### Problems with Traditional JAR Deployment
- **Complex classpath**: Need to manage multiple JAR files
- **Dependency conflicts**: Version mismatches between libraries
- **Deployment complexity**: Multiple files to transfer and configure
- **Runtime classpath issues**: `java -cp "app.jar:lib/*"` can fail if lib directory is missing

#### Benefits of Fat JAR Approach
- **Single file deployment**: One JAR contains everything needed
- **No classpath issues**: `java -jar` works universally
- **Simplified server deployment**: Just copy one file
- **Version isolation**: All dependencies locked at build time
- **Self-contained**: No external dependencies required

### Fat JAR Creation Process

The Maven Shade Plugin creates the fat JAR by:
1. **Resolving all dependencies** from Maven repositories
2. **Merging all classes** from dependencies into the final JAR
3. **Handling conflicts** by choosing the most recent version
4. **Adding manifest entries** for executable JAR (Main-Class)

### Deployment Folder Structure

```
Spring-Framework-Java-Brains/
├── deployment/
│   └── Spring-Framework-Java-Brains-1.0-SNAPSHOT.jar  # 6.9MB fat JAR
├── src/
├── target/
├── pom.xml
└── README.md
```

## Server Deployment Instructions

### Step 1: Build the Application
```bash
# Navigate to project directory
cd Spring-Framework-Java-Brains

# Clean and build the fat JAR
mvn clean package
```

### Step 2: Prepare Deployment Package
```bash
# Create deployment directory with fat JAR
mkdir -p deployment
cp target/Spring-Framework-Java-Brains-1.0-SNAPSHOT.jar deployment/
```

### Step 3: Deploy to Server

#### Option A: Direct File Transfer
```bash
# Copy to server using SCP
scp deployment/Spring-Framework-Java-Brains-1.0-SNAPSHOT.jar user@server:/path/to/app/

# Or using SFTP/rsync
rsync -avz deployment/ user@server:/path/to/app/
```

#### Option B: Using Docker
Create `Dockerfile`:
```dockerfile
FROM openjdk:17-jdk-slim
WORKDIR /app
COPY deployment/Spring-Framework-Java-Brains-1.0-SNAPSHOT.jar app.jar
CMD ["java", "-jar", "app.jar"]
```

Build and run:
```bash
docker build -t spring-drawing-app .
docker run spring-drawing-app
```

### Step 4: Run on Server

#### Simple Execution
```bash
# SSH to server
ssh user@server

# Navigate to application directory
cd /path/to/app

# Run the application
java -jar Spring-Framework-Java-Brains-1.0-SNAPSHOT.jar
```

#### Production Execution (Recommended)
```bash
# Run with JVM tuning for production
java -Xmx512m -Xms256m -jar Spring-Framework-Java-Brains-1.0-SNAPSHOT.jar

# Or with logging
java -jar Spring-Framework-Java-Brains-1.0-SNAPSHOT.jar > app.log 2>&1 &
```

## Application Features

The DrawingApp demonstrates:
- **Spring IoC Container**: Dependency injection
- **Aspect-Oriented Programming**: Custom retry aspect
- **Bean Configuration**: XML-based configuration + Spring annotation based Beans Creation and Injection
- **Spring AOP**: Method interception and advice

## Project Structure

```
Spring-Framework-Java-Brains/
├── src/main/java/com/kapil/spring/
│   ├── DrawingApp.java          # Main application class
│   ├── Circle.java             # Shape implementation
│   ├── Triangle.java           # Shape implementation
│   ├── Shape.java              # Interface
│   ├── Point.java              # Model class
│   ├── annotations/
│   │   └── Retry.java          # Custom annotation
│   └── aspects/
│       └── RetryAspect.java    # AOP aspect
├── src/main/resources/
│   └── spring.xml              # Spring configuration
├── deployment/                 # Deployable artifacts
├── target/                     # Build output
├── pom.xml                     # Maven configuration
└── README.md                   # This file
```

## Troubleshooting

### Verification Commands

```bash
# Check JAR contents
jar -tf target/Spring-Framework-Java-Brains-1.0-SNAPSHOT.jar | head -10

# Check manifest
unzip -p target/Spring-Framework-Java-Brains-1.0-SNAPSHOT.jar META-INF/MANIFEST.MF

# Test locally before deployment
java -jar target/Spring-Framework-Java-Brains-1.0-SNAPSHOT.jar
```

## Requirements

- **Java**: JDK 17 or higher
- **Maven**: 3.6 or higher
- **Operating System**: Linux, macOS, or Windows

## Build & Run Summary

```bash
# Development
mvn clean compile          # Compile
mvn exec:java             # Run with Maven

# Production Build
mvn clean package         # Create fat JAR

# Deployment
java -jar Spring-Framework-Java-Brains-1.0-SNAPSHOT.jar  # Run anywhere
```

This approach ensures reliable, reproducible deployments with zero external dependency management on the target server.
